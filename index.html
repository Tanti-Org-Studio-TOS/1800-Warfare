
<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>·Äô·Äº·Ä±·Ä¨·ÄÄ·Ä∫·Ä°·Äô·Ä±·Äõ·Ä≠·ÄÄ ·ÅÅ·Åà·ÅÄ·ÅÄ ‚Äî RTS + TBS Strategy</title>

  <!-- Leaflet CSS (CDN) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

  <style>
    :root {
      --bg: #ffffff;
      --text: #1c1c1c;
      --card: #f5f5f7;
      --border: #dadada;
      --accent: #0057ff;
      --accent-2: #0f9d58;
    }
    body[data-theme="dark"] {
      --bg: #0f1115;
      --text: #eaeaea;
      --card: #171a21;
      --border: #2a2e37;
      --accent: #5aa1ff;
      --accent-2: #34a853;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, Segoe UI, "Myanmar Khyay", "Myanmar Sangam MN", "Noto Sans Myanmar", Roboto, Arial, sans-serif;
    }
    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 12px;
      border-bottom: 1px solid var(--border);
      background: var(--card);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    .brand { display: flex; align-items: center; gap: 8px; }
    .brand .logo { font-weight: 700; }
    .controls > * { margin-left: 8px; }
    .switch { display: inline-flex; align-items: center; gap: 6px; }
    .file-label {
      display: inline-flex; align-items: center; gap: 6px;
      background: var(--card); border: 1px dashed var(--border);
      padding: 4px 8px; border-radius: 6px; cursor: pointer;
    }
    .file-label input { display: none; }
    main {
      display: grid; grid-template-columns: 320px 1fr;
      height: calc(100vh - 56px);
    }
    #sidebar { overflow: auto; border-right: 1px solid var(--border); background: var(--bg); }
    .panel { padding: 12px; border-bottom: 1px solid var(--border); }
    #map { height: 100%; width: 100%; }
    button, select, input {
      color: var(--text); background: var(--card); border: 1px solid var(--border);
      border-radius: 6px; padding: 6px 8px;
    }
    button:hover { border-color: var(--accent); }
    #legend { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
    .legend-item { display: flex; align-items: center; gap: 8px; }
    .swatch { width: 16px; height: 16px; border-radius: 3px; border: 1px solid var(--border); }
    .unit-badge {
      background: var(--accent); color: white; padding: 2px 6px; border-radius: 8px;
      border: 1px solid rgba(0,0,0,0.2); font-size: 12px;
    }
    footer { padding: 6px 12px; border-top: 1px solid var(--border); background: var(--card); }
  </style>
</head>
<body data-theme="light">
  <header class="topbar">
    <div class="brand">
      <span class="logo">‚õØ</span>
      <span id="title">·Äô·Äº·Ä±·Ä¨·ÄÄ·Ä∫·Ä°·Äô·Ä±·Äõ·Ä≠·ÄÄ ·ÅÅ·Åà·ÅÄ·ÅÄ ‚Äî ·Äõ·ÄØ·Äï·Ä∫·Äõ·Äæ·ÄÑ·Ä∫·Äî·Ä≤·Ä∑·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·ÄÖ·ÄΩ·Äô·Ä∫·Ä∏ RTS + TBS</span>
    </div>
    <div class="controls">
      <select id="lang">
        <option value="my">·Äô·Äº·Äî·Ä∫·Äô·Ä¨</option>
        <option value="en">English</option>
      </select>

      <button id="themeToggle">‚òÄÔ∏è Light</button>

      <label class="switch">
        <input type="checkbox" id="pauseRTS">
        <span id="pauseRTSLabel">RTS ·Äï·Ä≠·Äê·Ä∫·Äë·Ä¨·Ä∏</span>
      </label>

      <label>
        <span id="speedLabel">·Ä°·Äô·Äº·Äî·Ä∫·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏</span>
        <input type="range" id="speed" min="0.25" max="3" step="0.25" value="1">
      </label>

      <button id="startTurnBtn">üèÅ <span id="startTurnText">Turn ·ÄÖ</span></button>
      <button id="endTurnBtn">‚è≠ <span id="endTurnText">Turn ·Äï·Äº·ÄÆ·Ä∏</span></button>

      <label class="file-label">
        <input type="file" id="geojsonFile" accept=".geojson,.json" />
        <span id="loadGeoJSONText">GeoJSON ·Äê·ÄÑ·Ä∫</span>
      </label>

      <select id="basemap">
        <option value="osm">OpenStreetMap</option>
        <option value="opentopo">OpenTopoMap</option>
      </select>
    </div>
  </header>

  <main>
    <div id="sidebar">
      <section class="panel">
        <h3 id="gameStateTitle">·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·Ä°·ÄÅ·Äº·Ä±·Ä°·Äî·Ä±</h3>
        <div id="gameState">
          <div><strong id="turnText">Turn</strong>: <span id="turnNumber">1</span> (<span id="dateText">·Äá·Äî·Ä∫ 1800</span>)</div>
          <div><strong id="rtsText">RTS</strong>: <span id="rtsStatus">·Äõ·ÄØ·Äï·Ä∫·Äõ·Äæ·ÄÑ·Ä∫·Ä°·Äú·ÄØ·Äï·Ä∫·Äú·ÄØ·Äï·Ä∫·Äî·Ä±</span></div>
          <div><strong id="resText">·Ä°·Äõ·ÄÑ·Ä∫·Ä∏·Ä°·Äô·Äº·ÄÖ·Ä∫</strong>:
            <ul id="resourceList">
              <li>Food: <span id="resFood">0.0</span></li>
              <li>Gold: <span id="resGold">0.0</span></li>
              <li>Wood: <span id="resWood">0.0</span></li>
              <li>Iron: <span id="resIron">0.0</span></li>
            </ul>
          </div>
        </div>
      </section>

      <section class="panel">
        <h3 id="factionsTitle">Faction ·Äô·Äª·Ä¨·Ä∏</h3>
        <ul id="factionList"></ul>
      </section>

      <section class="panel">
        <h3 id="unitsTitle">·Äö·Ä∞·Äî·ÄÖ·Ä∫·Äô·Äª·Ä¨·Ä∏</h3>
        <button id="addUnitBtn">‚ûï <span id="addUnitText">·Äö·Ä∞·Äî·ÄÖ·Ä∫·Äë·Ää·Ä∑·Ä∫</span></button>
        <ul id="unitList"></ul>
      </section>

      <section class="panel">
        <h3 id="legendTitle">·Ä°·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ Legend</h3>
        <div id="legend"></div>
      </section>
    </div>

    <div id="map"></div>
  </main>

  <footer>
    <small id="footerText">
      Demo build. Territory GeoJSON here is placeholder (not historically accurate). Upload your own 1800-boundaries for authentic gameplay.
    </small>
  </footer>

  <!-- Leaflet JS (CDN) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Placeholder GeoJSON embedded inline -->
  <script id="placeholderGeoJSON" type="application/json">
  {
    "type": "FeatureCollection",
    "name": "north_america_1800_placeholder",
    "features": [
      {
        "type": "Feature",
        "properties": { "name": "United States (approx. east)", "factionId": "usa", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-90, 37], [-75, 37], [-75, 45], [-90, 45], [-90, 37]]] }
      },
      {
        "type": "Feature",
        "properties": { "name": "New Spain (approx.)", "factionId": "newspain", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-110, 25], [-95, 25], [-95, 32], [-110, 32], [-110, 25]]] }
      },
      {
        "type": "Feature",
        "properties": { "name": "British (Canada approx.)", "factionId": "british", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-90, 50], [-70, 50], [-70, 57], [-90, 57], [-90, 50]]] }
      },
      {
        "type": "Feature",
        "properties": { "name": "Russian America (Alaska approx.)", "factionId": "russian", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-160, 55], [-140, 55], [-140, 62], [-160, 62], [-160, 55]]] }
      },
      {
        "type": "Feature",
        "properties": { "name": "Saint-Domingue (Hispaniola West approx.)", "factionId": "saintdomingue", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-73.5, 18.5], [-72, 18.5], [-72, 19.5], [-73.5, 19.5], [-73.5, 18.5]]] }
      },
      {
        "type": "Feature",
        "properties": { "name": "Native Nations (Great Plains approx.)", "factionId": "native", "isPlaceholder": true },
        "geometry": { "type": "Polygon", "coordinates": [[[-105, 38], [-95, 38], [-95, 46], [-105, 46], [-105, 38]]] }
      }
    ]
  }
  </script>

  <script>
    // ===== i18n (·Äô·Äº·Äî·Ä∫·Äô·Ä¨ / English) =====
    const i18n = {
      my: {
        title: "·Äô·Äº·Ä±·Ä¨·ÄÄ·Ä∫·Ä°·Äô·Ä±·Äõ·Ä≠·ÄÄ ·ÅÅ·Åà·ÅÄ·ÅÄ ‚Äî ·Äõ·ÄØ·Äï·Ä∫·Äõ·Äæ·ÄÑ·Ä∫·Äî·Ä≤·Ä∑·Ä°·Ä±·Ä¨·ÄÑ·Ä∫·ÄÖ·ÄΩ·Äô·Ä∫·Ä∏ RTS + TBS",
        pauseRTSLabel: "RTS ·Äï·Ä≠·Äê·Ä∫·Äë·Ä¨·Ä∏",
        speedLabel: "·Ä°·Äô·Äº·Äî·Ä∫·Äî·Äæ·ÄØ·Äî·Ä∫·Ä∏",
        startTurnText: "Turn ·ÄÖ",
        endTurnText: "Turn ·Äï·Äº·ÄÆ·Ä∏",
        loadGeoJSONText: "GeoJSON ·Äê·ÄÑ·Ä∫",
        gameStateTitle: "·ÄÇ·Ä≠·Äô·Ä∫·Ä∏·Ä°·ÄÅ·Äº·Ä±·Ä°·Äî·Ä±",
        turnText: "Turn",
        dateText: "·Äõ·ÄÄ·Ä∫·ÄÖ·ÄΩ·Ä≤",
        rtsText: "RTS",
        resText: "·Ä°·Äõ·ÄÑ·Ä∫·Ä∏·Ä°·Äô·Äº·ÄÖ·Ä∫",
        factionsTitle: "Faction ·Äô·Äª·Ä¨·Ä∏",
        unitsTitle: "·Äö·Ä∞·Äî·ÄÖ·Ä∫·Äô·Äª·Ä¨·Ä∏",
        addUnitText: "·Äö·Ä∞·Äî·ÄÖ·Ä∫·Äë·Ää·Ä∑·Ä∫",
        legendTitle: "·Ä°·Äõ·Ä±·Ä¨·ÄÑ·Ä∫ Legend",
        footerText:
          "Demo build. Territory GeoJSON here is placeholder (not historically accurate). Upload your own 1800-boundaries for authentic gameplay.",
        rtsRunning: "·Äõ·ÄØ·Äï·Ä∫·Äõ·Äæ·ÄÑ·Ä∫·Ä°·Äú·ÄØ·Äï·Ä∫·Äú·ÄØ·Äï·Ä∫·Äî·Ä±",
        rtsPaused: "·Äõ·ÄØ·Äï·Ä∫·Äõ·Äæ·ÄÑ·Ä∫·Äï·Ä≠·Äê·Ä∫·Äë·Ä¨·Ä∏",
      },
      en: {
        title: "North America 1800 ‚Äî Strategy (RTS + TBS)",
        pauseRTSLabel: "RTS Paused",
        speedLabel: "Speed",
        startTurnText: "Start Turn",
        endTurnText: "End Turn",
        loadGeoJSONText: "Load GeoJSON",
        gameStateTitle: "Game State",
        turnText: "Turn",
        dateText: "Date",
        rtsText: "RTS",
        resText: "Resources",
        factionsTitle: "Factions",
        unitsTitle: "Units",
        addUnitText: "Add Unit",
        legendTitle: "Color Legend",
        footerText:
          "Demo build. Territory GeoJSON here is placeholder (not historically accurate). Upload your own 1800-boundaries for authentic gameplay.",
        rtsRunning: "Running",
        rtsPaused: "Paused",
      },
    };

    // ===== Factions & Colors =====
    const factions = [
      { id: "usa", name_my: "·Ä°·Äô·Ä±·Äõ·Ä≠·ÄÄ·Äî·Ä∫·Äï·Äº·Ää·Ä∫·Äë·Ä±·Ä¨·ÄÑ·Ä∫·ÄÖ·ÄØ (·ÅÅ·Åà·ÅÄ·ÅÄ)", name_en: "United States (1800)", color: "#3a86ff" },
      { id: "newspain", name_my: "New Spain (·ÄÖ·Äï·Ä≠·Äî·Ä∫)", name_en: "New Spain (Spanish Empire)", color: "#ff006e" },
      { id: "british", name_my: "·Äó·Äº·Ä≠·Äê·Ä≠·Äû·Äª·Äæ (·ÄÄ·Äî·Ä±·Äí·Ä´)", name_en: "British (Canada)", color: "#8338ec" },
      { id: "russian", name_my: "·Äõ·ÄØ·Äõ·Äæ·Ä¨·Ä∏ (·Ä°·Äö·Ä∫·Äú·Äï·Ä∫·ÄÖ·ÄÄ·Ä¨)", name_en: "Russian (Alaska)", color: "#fb5607" },
      { id: "saintdomingue", name_my: "Saint-Domingue/·Äü·Ä±·Äê·ÄÆ", name_en: "Saint-Domingue/Haiti", color: "#2a9d8f" },
      { id: "native", name_my: "Native Nations", name_en: "Native Nations", color: "#6a994e" },
      { id: "neutral", name_my: "·Ä°·Äú·Äö·Ä∫·Ä°·Äú·Äê·Ä∫", name_en: "Neutral", color: "#adb5bd" },
    ];

    let currentLang = "my";
    let map, baseLayers = {}, territoryLayer;
    let units = [];
    let selectedUnitId = null;

    const gameState = {
      turn: 1,
      date: { year: 1800, month: 1 }, // month 1-12
      rtsPaused: false,
      speed: 1.0,
      resources: { food: 0, gold: 0, wood: 0, iron: 0 },
    };
    let rtsInterval = null;

    // ===== Map init (Leaflet) =====
    function initMap() {
      map = L.map("map", {
        center: [40.0, -100.0], // North America center-ish
        zoom: 4,
        minZoom: 3,
        maxZoom: 12,
        worldCopyJump: true,
      });

      const osm = L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
        attribution: '&copy; OpenStreetMap contributors',
      }).addTo(map);

      const opentopo = L.tileLayer(
        "https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",
        { attribution: '&copy; OpenStreetMap, SRTM | &copy; OpenTopoMap' }
      );

      baseLayers = { osm, opentopo };

      territoryLayer = L.geoJSON(null, {
        style: feature => ({
          color: "#222",
          weight: 1,
          fillColor: getFactionColor(feature?.properties?.factionId),
          fillOpacity: 0.35,
        }),
        onEachFeature: (feature, layer) => {
          const name = feature.properties?.name || "Unknown";
          const factionId = feature.properties?.factionId || "neutral";
          const isPlaceholder = feature.properties?.isPlaceholder ? " (placeholder)" : "";
          layer.bindPopup(`<strong>${name}</strong><br/>Faction: ${factionId}${isPlaceholder}`);
          layer.on("click", () => {
            console.log("Territory clicked:", feature.properties);
          });
        },
      }).addTo(map);
    }

    function getFactionColor(id) {
      const f = factions.find(f => f.id === id);
      return f ? f.color : "#adb5bd";
    }

    function renderLegend() {
      const el = document.getElementById("legend");
      el.innerHTML = "";
      factions.forEach(f => {
        const item = document.createElement("div");
        item.className = "legend-item";
        item.innerHTML = `
          <span class="swatch" style="background:${f.color}"></span>
          <span>${currentLang === "my" ? f.name_my : f.name_en}</span>
        `;
        el.appendChild(item);
      });
    }

    function renderFactionList() {
      const list = document.getElementById("factionList");
      list.innerHTML = "";
      factions.forEach(f => {
        const li = document.createElement("li");
        li.textContent = currentLang === "my" ? f.name_my : f.name_en;
        list.appendChild(li);
      });
    }

    // ===== Game Loop (RTS + TBS) =====
    function startRTSLoop() {
      if (rtsInterval) clearInterval(rtsInterval);
      // Tick every 1000ms; scale yields by speed
      rtsInterval = setInterval(() => {
        if (gameState.rtsPaused) return;
        const s = gameState.speed;
        gameState.resources.food += 0.8 * s;
        gameState.resources.gold += 0.3 * s;
        gameState.resources.wood += 0.5 * s;
        gameState.resources.iron += 0.2 * s;
        updateResourceUI();
      }, 1000);
    }

    function updateResourceUI() {
      document.getElementById("resFood").textContent = gameState.resources.food.toFixed(1);
      document.getElementById("resGold").textContent = gameState.resources.gold.toFixed(1);
      document.getElementById("resWood").textContent = gameState.resources.wood.toFixed(1);
      document.getElementById("resIron").textContent = gameState.resources.iron.toFixed(1);
    }

    function nextMonth() {
      gameState.date.month++;
      if (gameState.date.month > 12) {
        gameState.date.month = 1;
        gameState.date.year++;
      }
      document.getElementById("dateText").textContent = monthName(gameState.date.month) + " " + gameState.date.year;
    }

    function monthName(m) {
      const en = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][m-1];
      if (currentLang === "my") {
        const my = ["·Äá·Äî·Ä∫","·Äñ·Ä±","·Äô·Äê·Ä∫","·Äß","·Äô·Ä±","·Äá·ÄΩ·Äî·Ä∫","·Äá·Ä∞","·Ä©","·ÄÖ·ÄÄ·Ä∫","·Ä°·Ä±·Ä¨·ÄÄ·Ä∫","·Äî·Ä≠·ÄØ","·Äí·ÄÆ"][m-1];
        return my;
      }
      return en;
    }

    function endTurn() {
      // Turn-based resolution hooks (upkeep, events)
      gameState.resources.food = Math.max(0, gameState.resources.food - 0.5);
      gameState.resources.wood = Math.max(0, gameState.resources.wood - 0.2);
      gameState.turn++;
      document.getElementById("turnNumber").textContent = gameState.turn;
      nextMonth();
      updateResourceUI();
    }

    // ===== Units =====
    let unitCounter = 0;
    function addUnit(latlng = [39.0, -95.0], factionId = "usa") {
      const id = ++unitCounter;
      const iconHtml = `<div class="unit-badge">U${id}</div>`;
      const icon = L.divIcon({ html: iconHtml, className: "unit-icon", iconSize: [24,24] });
      const marker = L.marker(latlng, { icon, draggable: false }).addTo(map);

      marker.on("click", () => {
        selectedUnitId = id;
        highlightSelected(marker);
      });

      // Move selected unit on map click
      map.on("click", e => {
        if (selectedUnitId === id) {
          moveUnit(marker, e.latlng);
        }
      });

      const unit = { id, marker, factionId, latlng };
      units.push(unit);
      renderUnitList();
    }

    function moveUnit(marker, targetLatLng) {
      const start = marker.getLatLng();
      const steps = 40;
      let i = 0;
      const dx = (targetLatLng.lat - start.lat) / steps;
      const dy = (targetLatLng.lng - start.lng) / steps;
      const interval = setInterval(() => {
        i++;
        marker.setLatLng([start.lat + dx * i, start.lng + dy * i]);
        if (i >= steps) clearInterval(interval);
      }, 25);
    }

    function highlightSelected(marker) {
      marker.setZIndexOffset(1000);
    }

    function renderUnitList() {
      const list = document.getElementById("unitList");
      list.innerHTML = "";
      units.forEach(u => {
        const ll = u.marker.getLatLng();
        const li = document.createElement("li");
        li.textContent = `U${u.id} ‚Äî ${u.factionId} @ ${ll.lat.toFixed(2)}, ${ll.lng.toFixed(2)}`;
        list.appendChild(li);
      });
    }

    // ===== GeoJSON Load (Placeholder & File) =====
    function loadPlaceholderTerritories() {
      try {
        const raw = document.getElementById("placeholderGeoJSON").textContent;
        const gj = JSON.parse(raw);
        territoryLayer.clearLayers();
        territoryLayer.addData(gj);
      } catch (e) {
        console.warn("Failed to load placeholder territories:", e);
      }
    }

    function handleGeoJSONFileInput(file) {
      const reader = new FileReader();
      reader.onload = () => {
        try {
          const gj = JSON.parse(reader.result);
          territoryLayer.clearLayers();
          territoryLayer.addData(gj);
          alert(currentLang === "my" ? "GeoJSON ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ·Ä∏!" : "GeoJSON loaded.");
        } catch (e) {
          alert(currentLang === "my" ? "GeoJSON ·Äô·Äô·Äæ·Äî·Ä∫·Äï·Ä´!" : "Invalid GeoJSON.");
        }
      };
      reader.readAsText(file);
    }

    // ===== Language & Theme =====
    function applyLang() {
      const t = i18n[currentLang];
      document.getElementById("title").textContent = t.title;
      document.getElementById("pauseRTSLabel").textContent = t.pauseRTSLabel;
      document.getElementById("speedLabel").textContent = t.speedLabel;
      document.getElementById("startTurnText").textContent = t.startTurnText;
      document.getElementById("endTurnText").textContent = t.endTurnText;
      document.getElementById("loadGeoJSONText").textContent = t.loadGeoJSONText;
      document.getElementById("gameStateTitle").textContent = t.gameStateTitle;
      document.getElementById("turnText").textContent = t.turnText;
      document.getElementById("dateText").textContent = monthName(gameState.date.month) + " " + gameState.date.year;
      document.getElementById("rtsText").textContent = t.rtsText;
      document.getElementById("resText").textContent = t.resText;
      document.getElementById("factionsTitle").textContent = t.factionsTitle;
      document.getElementById("unitsTitle").textContent = t.unitsTitle;
      document.getElementById("addUnitText").textContent = t.addUnitText;
      document.getElementById("legendTitle").textContent = t.legendTitle;
      document.querySelector("footer small").textContent = t.footerText;
      document.getElementById("rtsStatus").textContent =
        gameState.rtsPaused ? t.rtsPaused : t.rtsRunning;
      renderFactionList();
      renderLegend();
    }

    function toggleTheme() {
      const body = document.body;
      const current = body.getAttribute("data-theme");
      const next = current === "light" ? "dark" : "light";
      body.setAttribute("data-theme", next);
      document.getElementById("themeToggle").textContent = next === "light" ? "‚òÄÔ∏è Light" : "üåô Dark";
    }

    // ===== Basemap Switch =====
    function applyBasemap(value) {
      Object.values(baseLayers).forEach(layer => {
        if (map.hasLayer(layer)) map.removeLayer(layer);
      });
      baseLayers[value].addTo(map);
    }

    // ===== Boot =====
    window.addEventListener("DOMContentLoaded", () => {
      // Restore language if previously saved
      const savedLang = localStorage.getItem("lang");
      if (savedLang) {
        currentLang = savedLang;
      }
      document.getElementById("lang").value = currentLang;

      initMap();
      loadPlaceholderTerritories();
      startRTSLoop();

      // default unit
      addUnit([39.0, -95.0], "usa");

      // UI bindings
      document.getElementById("lang").addEventListener("change", e => {
        currentLang = e.target.value;
        localStorage.setItem("lang", currentLang);
        applyLang();
      });
      applyLang();

      document.getElementById("themeToggle").addEventListener("click", toggleTheme);

      document.getElementById("pauseRTS").addEventListener("change", e => {
        gameState.rtsPaused = e.target.checked;
        document.getElementById("rtsStatus").textContent =
          gameState.rtsPaused ? i18n[currentLang].rtsPaused : i18n[currentLang].rtsRunning;
      });

      document.getElementById("speed").addEventListener("input", e => {
        gameState.speed = parseFloat(e.target.value);
        // no need to restart interval; scaling inside tick
      });

      document.getElementById("startTurnBtn").addEventListener("click", () => {
        alert(currentLang === "my" ? "Turn ·ÄÖ·Äê·ÄÑ·Ä∫·Äï·Äº·ÄÆ!" : "Turn started!");
      });

      document.getElementById("endTurnBtn").addEventListener("click", endTurn);

      document.getElementById("addUnitBtn").addEventListener("click", () => {
        addUnit([41.0, -87.0], "usa");
      });

      document.getElementById("geojsonFile").addEventListener("change", e => {
        const file = e.target.files?.[0];
        if (file) handleGeoJSONFileInput(file);
      });

      document.getElementById("basemap").addEventListener("change", e => {
        applyBasemap(e.target.value);
      });
    });
  </script>
</body>
</html>
``
